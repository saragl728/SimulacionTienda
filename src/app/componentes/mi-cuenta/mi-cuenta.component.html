<div class="container mt-4 bg-primary-subtle border border-primary rounded border-2">
    @if (!this.sesionIniciada){
        <div>
            <h2 i18n>Inicia sesión para ver el estado de tu cuenta</h2>
            <div class="mb-3">
                <label for="usuario" class="form-label fw-bold" i18n>Usuario</label>
                <input type="text" name="usuario" id="usuario" class="form-control" i18n-placeholder placeholder="Usuario" [(ngModel)]="persona.nombre">
            </div>
            <div class="mb-3">
                <label class="form-label fw-bold" i18n>Contraseña:</label>
                <input type="password" name="contrasenya" id="contrasenya" class="form-control" i18n-placeholder placeholder="Contraseña" [(ngModel)]="persona.contrasenya"/>
            </div>
            <button type="submit" class="btn btn-primary mb-3" i18n (click)="inicioSesion()">Iniciar sesión</button>
        </div>
    }
    @else{
        <div>
            <h2 i18n>Mi cuenta</h2>
            <div class="shadow card p-3 my-2 border border-dark border-2">
                <h5 class="card-title" i18n>Email</h5>
                <h6> {{ persona.correo }}</h6>
                <h5 class="card-title" i18n>Fecha de nacimiento</h5>
                <h6> {{ persona.fechaNac }}</h6>
                <h5 class="card-title" i18n>Mi saldo</h5>
                <h6> {{ persona.saldo }} €</h6>
                @if (inventario.length > 0){
                    <h5 class="card-title" i18n>Mi inventario</h5>
                    <table class="table table-bordered table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th i18n>Producto</th>
                                <th i18n>Cantidad</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (inv of inventario;let i = $index; track i){
                                <tr>
                                    <td> {{ inv.producto }} </td>
                                    <td> {{ inv.cantidad }} </td>              
                                </tr>
                            }
                        </tbody>
                    </table>
                }

                @if (misReses.length > 0){
                    <h5 class="card-title" i18n>Mis opiniones</h5>
                    <table class="table table-bordered table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th i18n>Producto</th>
                                <th i18n>Opinión</th>
                                <th i18n>Fecha</th>
                            </tr>
                        </thead>
                        <tbody>
                            @for (resen of misReses;let j = $index; track j){
                                <tr>
                                    <td> {{ resen.producto }} </td>
                                    <td> {{ resen.opinion }} </td>
                                    <td> {{ resen.fecha }} </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                }

            </div>
            <div class="shadow card p-3 my-2 border border-dark border-2">
                <h5 class="card-title" i18n>Cambiar mi nombre</h5>
                <div class="mb-3">
                    <label class="form-label fw-bold" i18n>Nuevo nombre(max 50 caracteres):</label>
                    <input type="text" id="nombre" class="form-control" [(ngModel)]="persona.nombre"/>                    
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-warning" i18n (click)="cambiarNombre()">Modificar</button>
                </div>
            </div>
            <div class="shadow card p-3 my-2 border border-dark border-2">
                <h5 class="card-title" i18n>Cambiar mi contraseña</h5>
                @if (persona.contrasenya != contr2){
                    <h3 i18n class="text-danger-emphasis bg-warning-subtle p-2 border border-dark border-2 rounded"><span class="material-symbols-outlined"> error </span>Las contraseñas no coinciden</h3>
                }
                @else{
                    <h3 i18n class="bg-success-subtle border border-light p-2 border-2 rounded"><span class="material-symbols-outlined"> check_circle </span>Las contraseñas coinciden</h3>
                }
                <div class="mb-3">
                    <label class="form-label fw-bold" i18n>Nueva contraseña:</label>
                    <input type="password" id="contrasenya" class="form-control" [(ngModel)]="persona.contrasenya"/>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold" i18n>Repite la contraseña:</label>
                    <input type="password" id="contrasenya2" class="form-control" [(ngModel)]="contr2"/>
                </div>
                <div class="d-flex gap-2">
                    <button class="btn btn-warning" i18n (click)="cambiarContrasenya()">Modificar</button>
                </div>
            </div>

        </div>
        
        <!--sólo se mostrará si un administrador ha iniciado sesión-->
        @if (usuarioAdmin){

        }

    }
</div>
